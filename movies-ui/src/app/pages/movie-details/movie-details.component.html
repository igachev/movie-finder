
<section class="w-11/12 mx-auto flex flex-col bg-slate-300 rounded-lg my-3 p-3 ">
    <h2 class="text-xl sm:text-xl md:text-4xl py-2 px-1 font-bold tracking-wide uppercase text-center">Movie Details</h2>

    <article *ngIf="errorMessage">
        <h3>Error: {{ errorMessage }}</h3>
    </article>

    <article *ngIf="movie" class=" flex flex-col gap-4 bg-slate-400 border border-gray-200 rounded p-3">
        <h4 class="text-lg sm:text-2xl md:text-3xl font-bold py-1 indent-3 font-mono">Title: {{ movie.title }}</h4>
        <div class="w-3/3 h-110">
            <img src="{{ images[0] }}" alt="Main Movie Poster" class="rounded-md">
        </div>
        <article class="flex flex-row gap-3">
            <div *ngFor="let image of images | slice:1; let i = index; trackBy: trackByImageIndex" class="w-3/3 sm:w-1/3 h-80">
                <img src="{{ image }}" alt="movie poster {{ i }}" class="rounded-md">
            </div>
        </article>
        <p class="text-sm font-light sm:text-base md:text-xl py-1 font-serif">Description: {{ movie.description }}</p>
        <p class="text-sm font-light sm:text-base md:text-xl py-1 font-serif">Genre: <span *ngFor="let genre of movie?.genres">{{ genre.genreName }} </span></p>
        <h5 class="text-lg sm:text-2xl md:text-3xl font-bold py-1 indent-3 font-mono text-center">Comments:</h5>
        <article *ngIf="movie?.comments!.length > 0" class="border rounded-md p-2">
            <div *ngFor="let comment of movie?.comments; trackBy: trackByCommentId" class="flex flex-col bg-slate-300 p-3 my-3 rounded-xl">
                <h6 class="text-base sm:text-xl md:text-xl font-medium p-1">
                    {{ comment.createdBy }} 
                    <span class="text-sm font-medium font-mono block italic">{{ comment.createdOn | date:'yyyy-MM-dd HH:mm:ss'}}</span>
                </h6>
                <p class="text-sm sm:text-base md:text-lg ">{{ comment.content }}</p>
                <div *ngIf="comment.createdBy === username" class="my-2">
    <button (click)="showHideEdit($event,comment.id)" class="text-base text-white font-light tracking-wider sm:text-lg md:text-xl py-2 px-4 mx-2 bg-slate-900 rounded cursor-pointer hover:text-sky-400 transition duration-400">
        {{ selectedCommentId !== comment.id ? 'Edit' : 'Cancel' }}
    </button>
    <button (click)="deleteComment(comment.id)" class="text-base text-white font-light tracking-wider sm:text-lg md:text-xl py-2 px-4 bg-slate-900 rounded cursor-pointer hover:text-sky-400 transition duration-400">Delete</button>
                </div>
                <ng-container *ngIf="selectedCommentId === comment.id">
                    <app-edit-comment 
                    [movieId]="movie!.id" 
                    [commentId]="comment.id" 
                    (commentEmitter)="commentWasEdited($event)"></app-edit-comment>
                </ng-container>
            </div>
        </article>

        <ng-container *ngIf="movie?.comments!.length === 0">
            <p>No comments yet</p>
        </ng-container>

        <ng-container *ngIf="isLoggedIn">
        <app-add-comment (commentEmitter)="commentWasAdded($event)"></app-add-comment>
        </ng-container>
        
    </article>
</section>
